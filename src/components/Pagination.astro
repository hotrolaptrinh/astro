---
interface Props {
  page?: number;
  total?: number;
  extraQuery?: string;
  usePath?: boolean; // if true, build /page/N links using basePath
  basePath?: string; // e.g. Astro.site?.pathname or '/projects/'
}
const { page = 1, total = 5, extraQuery = "", usePath = false, basePath = "" } = Astro.props as Props;
const pages = Array.from({ length: total }, (_, i) => i + 1);

const normBase = (() => {
  const b = basePath || Astro.site?.pathname || "/";
  return b.endsWith("/") ? b : b + "/";
})();

const linkFor = (p:number) => {
  if (usePath) {
    const path = p === 1 ? `${normBase}` : `${normBase}page/${p}`;
    return extraQuery ? `${path}?${extraQuery.replace(/^&/, "")}` : path;
  }
  return `?page=${p}${extraQuery}`;
};
---
<nav class="join my-8 justify-center w-full">
  <a class="join-item btn btn-sm" href={linkFor(Math.max(1, page-1))}>«</a>
  {pages.map(p => (
    <a class={`join-item btn btn-sm ${p===page ? "btn-active" : ""}`} href={linkFor(p)}>{p}</a>
  ))}
  <a class="join-item btn btn-sm" href={linkFor(Math.min(total, page+1))}>»</a>
</nav>
